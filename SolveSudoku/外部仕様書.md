# SolveSudoku　外部仕様書

**開発履歴**

- 製品バージョン：1.0
- 内容：新規作成

**改定履歴**

- 版：1
- 改定日：2025/01/11
- 改定者：Claude
- 承認：-
- 内容：新規作成

## 1. 概要

SolveSudokuは、9x9の数独パズルを効率的に解くコンソールアプリケーションです。
制約伝播とバックトラッキングアルゴリズムを組み合わせることで、初級から最上級レベルまでの数独パズルを高速で解くことができます。

本機能の目的は以下の通りです：
- 数独愛好家への解答支援ツールの提供
- アルゴリズム学習者への実装例の提示
- 高性能数独ソルバーによる効率的なパズル解析

ユーザーは手動入力またはファイル入力により数独パズルを指定でき、解答までの時間を計測しながら結果を確認することができます。

## 2. 機能説明　SolveSudoku

### 2.1. 起動条件

- 実行環境：Windows、Linux、macOS
- 必要なランタイム：C++17対応コンパイラ
- メモリ使用量：約1MB未満
- 特別な権限：不要

### 2.2. 操作

コンソールベースのメニュー駆動型インターフェースを提供します。

```
=== 数独ソルバー ===
1. ファイルから読み込み
2. 手動入力
3. テストケース実行
選択してください (1-3):
```

**操作フロー：**
1. メインメニューから入力方法を選択
2. パズルデータの入力または読み込み
3. 自動解析の実行
4. 解答結果の表示
5. 必要に応じて結果をファイル保存

### 2.3. 入力パラメータ

#### 2.3.1. メニュー選択
| パラメータ | 型 | 範囲 | 説明 |
|-----------|----|----|------|
| choice | int | 1-3 | 入力方法の選択 |

#### 2.3.2. 数独パズルデータ
| パラメータ | 型 | 範囲 | 説明 |
|-----------|----|----|------|
| grid[9][9] | int | 0-9 | 数独の各セル（0は空セル） |

#### 2.3.3. ファイル入力
- **形式**: テキストファイル
- **構造**: 9行9列の数字（スペース区切り）
- **文字コード**: UTF-8
- **例**:
```
5 3 0 0 7 0 0 0 0
6 0 0 1 9 5 0 0 0
0 9 8 0 0 0 0 6 0
...
```

### 2.4. 出力結果

#### 2.4.1. 初期状態表示
パズルの初期状態を罫線付きの9x9グリッドで表示します。
```
┌───────┬───────┬───────┐
│ 5 3 · │ · 7 · │ · · · │
│ 6 · · │ 1 9 5 │ · · · │
│ · 9 8 │ · · · │ · 6 · │
├───────┼───────┼───────┤
...
```

#### 2.4.2. 解答結果
- **成功時**: 完全に埋められた9x9グリッドを表示
- **失敗時**: "この数独は解けません。" のメッセージ
- **統計情報**: 解析時間（マイクロ秒単位）、使用アルゴリズム、空セル数

#### 2.4.3. 出力ファイル
ユーザー指定により、解答結果をテキストファイルに保存可能：
- **形式**: 9行9列の数字（スペース区切り）
- **保存先**: `./out/` ディレクトリ

### 2.5. 特記事項

- 制約伝播のみで解ける場合は、バックトラッキングを実行せず高速処理
- 無効な数独パズル（解が存在しない、制約違反等）の検出機能付き
- 実行時間計測により、パズル難易度の客観的評価が可能

## 3. 関連設定

- コンパイル最適化：`-O2` フラグ推奨
- C++標準：C++17以上必須
- 実行時パラメータ：なし（すべて対話式）

## 4. 関連ファイル

### 4.1. 入力ファイル
| ファイル名 | パス | 説明 |
|-----------|------|------|
| test1.txt | ./in/ | 標準的な中級レベルパズル |
| test2.txt | ./in/ | 上級レベルパズル |
| easy.txt | ./in/ | 初級レベルパズル |
| hard.txt | ./in/ | 最上級レベルパズル |
| ユーザー指定ファイル | ./in/ | 任意の数独パズルファイル |

### 4.2. 出力ファイル
| ファイル名 | パス | 説明 |
|-----------|------|------|
| ユーザー指定ファイル | ./out/ | 解答結果テキストファイル |

## 5. 使用レジストリ一覧

本アプリケーションはレジストリを使用しません。

## 6. メッセージ一覧

### 6.1. エラーメッセージ一覧

| No. | メッセージ | 原因、対策 |
| --- | ---------- | ---------- |
| 1   | ファイルの読み込みに失敗しました。 | 指定されたファイルが存在しない、または読み取り権限がない。ファイルパスと権限を確認する。 |
| 2   | 入力に失敗しました。 | 手動入力時に無効な文字が入力された。数字（0-9）のみを入力する。 |
| 3   | 無効な数独パズルです。 | 入力されたパズルが数独のルールに違反している。重複する数字がないか確認する。 |
| 4   | 無効な入力です: 行X, 列Y | 指定された位置に無効な値が入力された。1-9の範囲で入力し直す。 |
| 5   | 保存に失敗しました。 | 出力ファイルの書き込み権限がない、またはディスク容量不足。権限とディスク容量を確認する。 |
| 6   | 無効な選択です。 | メニューで1-3以外の値が入力された。正しい選択肢を入力する。 |

### 6.2. ワーニングメッセージ一覧

| No. | メッセージ | 原因、対策 |
| --- | ---------- | ---------- |
| 1   | テストファイルが見つかりません。サンプルパズルを使用します。 | テストケース実行時にデフォルトファイルが見つからない。処理は継続されるが、ファイルの存在を確認することを推奨。 |

### 6.3. ガイドメッセージ一覧

| No. | メッセージ | 内容 | 備考 |
| --- | ---------- | ---- | ---- |
| 1   | 数独パズルを入力してください (0は空のセル): | 手動入力モード開始時の案内 | 81個の数字入力が必要 |
| 2   | 制約伝播のみで解決しました (時間: X マイクロ秒) | 論理的推論のみで解答完了 | 比較的簡単なパズル |
| 3   | バックトラッキングで解決しました (時間: X マイクロ秒) | 探索アルゴリズムで解答完了 | より複雑なパズル |
| 4   | この数独は解けません (時間: X マイクロ秒) | 解が存在しないパズル | パズルの入力ミスの可能性 |
| 5   | 解答をファイルに保存しますか? (y/n): | 結果保存の確認 | y/Y入力で保存処理開始 |
| 6   | 保存しました: ./out/ファイル名 | 保存完了通知 | 保存先パスを表示 |

## 7. 制限事項

1. **パズルサイズ**: 9x9の標準数独のみ対応（16x16等の拡張版は非対応）
2. **ファイルサイズ**: 入力ファイルは1KB以下を想定（標準的な数独ファイル）
3. **同時実行**: マルチスレッド非対応（1つのパズルを順次処理）
4. **メモリ使用量**: 大量のパズルを連続処理する機能なし
5. **GUI**: コンソールアプリケーションのみ（グラフィカルUIなし）

## 8. 運用上の注意

1. **ファイル権限**: ./in/ および ./out/ ディレクトリに対する読み書き権限が必要
2. **文字コード**: 入力ファイルはUTF-8形式で保存すること
3. **数値範囲**: 0-9以外の文字は無効な入力として処理される
4. **ディスク容量**: 出力ファイル保存時に十分な空き容量を確保すること
5. **パフォーマンス**: 極端に複雑なパズル（17ヒント等）では解析時間が延長される場合がある

## 9. 備考

- 本ソルバーは教育目的および研究目的での使用を想定している
- アルゴリズムの詳細については、ソースコード内のコメントを参照
- 制約伝播とバックトラッキングの組み合わせにより、市販の数独パズル集の99%以上を高速で解くことが可能
- 実行時間計測機能により、パズル作成者は難易度設定の参考データを得ることができる